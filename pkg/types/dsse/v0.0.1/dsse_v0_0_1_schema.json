{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "$id": "http://rekor.sigstore.dev/types/dsse/dsse_v0_0_1_schema.json",
    "title": "dsse v0.0.1 Schema",
    "description": "Schema for dsse object",
    "type": "object",
    "properties": {
        "payload": {
            "description": "payload of the envelope",
            "type": "string",
            "format": "byte",
            "writeOnly": true
        },
        "payloadType": {
            "description": "type describing the payload",
            "type": "string"
        },
        "payloadHash": {
            "description": "hash of the envelope's payload after being PAE encoded",
            "readOnly": true,
            "type": "object",
            "properties": {
                "algorithm": {
                    "description": "The hashing function used to compue the hash value",
                    "type": "string",
                    "enum": ["sha256"]
                },
                "value": {
                    "description": "The hash value of the PAE encoded payload",
                    "type": "string"
                }
            }
        },
        "signatures": {
            "description": "collection of all signatures of the envelope's payload",
            "type": "array",
            "minItems": 1,
            "items": {
                "description": "a signature of the envelope's payload along with the public key for the signature",
                "type": "object",
                "properties": {
                    "keyid": {
                        "description": "optional id of the key used to create the signature",
                        "type": "string"
                    },
                    "sig": {
                        "description": "signature of the payload",
                        "type": "string"
                    },
                    "publicKey": {
                        "description": "public key that corresponds to this signature",
                        "type": "string",
                        "format": "byte",
                        "readOnly": true
                    }
                }
            }
        }
    },
    "required": ["payloadType", "signatures"]
}
